<ion-header>
  <div class="header-container">
    <img class="header-logo" src="../../assets/imgs/logo_schriftzug_weiss.png" height="60">
    <div class="header-icons-div" *ngIf="!isApp">
      <button class="header-icon" (click)="goToCalendarPage()">
        <img src="../../assets/icon/icon_calendar.png" height="20"> {{"Calendar" | translate }}
      </button>
      <button class="header-icon" (click)="goToToDoPage()">
        <img src="../../assets/icon/icon_todo.png" height="20"> {{"ToDo" | translate }}
      </button>
      <button class="header-icon" (click)="goToProjectsPage()">
        <img src="../../assets/icon/icon_projects.png" height="20"> {{"Projects" | translate }}
      </button>
      <button class="header-icon" (click)="goToCapturePage()">
        <img src="../../assets/icon/icon_captures.png" height="20"> {{"Captures" | translate }}
      </button>
    </div>
  </div>
</ion-header>
 
  <ion-content padding>

  <!-- CapturePage -->
  <div class="primary" *ngIf="viewpoint == 'CapturePage'">
    <ion-row class="width-40 margin-auto height-20">
      <p>{{errorMsg | translate}}</p>
      <ion-card class="text-align-center height-40 overflow-scroll no-scrollbar margin-right-10 display-inline-block secondary border-radius-20px min-height-150px">
        <ion-input class="height-50" type="text" [(ngModel)]="newCapture.content" placeholder="{{'Input new capture'| translate}}"></ion-input>
        <button class="darkbutton width-auto" round ion-button (click)="addCapture(newCapture)">{{"Add" | translate}}</button>
      </ion-card>
    </ion-row>
    <div class="secondary border-radius-20px padding-bottom-10">
      <h3 class="padding-left-20">{{"Taken actions ready for processing" | translate}}:</h3>
      <p class="border-bottom-1 padding-left-20 padding-top-10" *ngFor="let takenAction of takenActionList | async" (click)="goToProcessTakenActionPage(takenAction)">{{"You started with action" |translate}} "{{takenAction.content}}" {{", click here to process" | translate }}
      </p>
    <h3 class="padding-left-20">{{"Thoughts captured and ready for processing" | translate}}:</h3>
      <p class="border-bottom-1 padding-left-20" *ngFor="let capture of captureList | async" (click)="goToProcessCapturePage(capture)">{{capture.content}}
      </p>
    </div>
  </div>

  <!-- ProcessCapturePage -->
  <div *ngIf="viewpoint=='ProcessCapturePage'">
    <p>{{errorMsg}}</p>
    <div *ngIf="pageCtrl == ''">
      <ion-grid>
        <ion-row class="width-100">
          <ion-col col-3>
            <ion-item class="secondary border-radius-20px padding-vertical-auto">
              <div class="margin-vertical-center-parent height-100 width-100">
              <p class="margin-vertical-center">{{capture.content}}</p>
            </div>
            </ion-item>
            <ion-card class="text-align-center margin-top-10 overflow-scroll no-scrollbar width-100 margin-left-0 display-inline-block secondary border-radius-20px">
              <ion-input type="text white" [(ngModel)]="goalname" placeholder="{{'Project name' | translate}}"></ion-input>

              <button ion-button round class="darkbutton margin-auto margin-bottom-10 margin-top-10" (click)="addGoal(goalname)">{{"Create" | translate }}</button>
            </ion-card>
          </ion-col>
          <ion-col>
            
            
            <ion-card class="max-width-400px overflow-x-hidden text-align-center padding-10 width-auto margin-top-0 height-20 overflow-scroll no-scrollbar margin-right-10 display-inline-block secondary border-radius-20px min-height-100px" no-lines *ngFor="let goal of goalList | async">
              <ion-grid>
                <ion-row>
                  <ion-col col-10>
                    <h1 class="max-height-30px overflow-x-hidden width-90">{{goal.name}}</h1>
                  </ion-col>
                  <ion-col>
                    <ion-card class="margin-top-0 margin-right-0 project-color" [ngStyle]="{'background-color': goal.color}"></ion-card>
                  </ion-col>
                </ion-row>
                <ion-row>
              
              <button class="darkbutton button-left" ion-button round (click)="addAction(goal)">{{"Action" | translate }}</button>
              <button class="darkbutton button-left" ion-button round (click)="addDelegation(goal)">{{"Delegation" | translate }}</button>
              <button class="darkbutton button-left" ion-button round (click)="addReference(goal)">{{"Reference" | translate }}</button>
                </ion-row>
              </ion-grid>
            </ion-card>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>
  </div>

  <!-- ProcessTakenActionPage -->
  <div *ngIf="viewpoint=='ProcessTakenActionPage'">
    <div *ngIf="pageCtrl == ''">
      {{"Please indicate whether you finished the action or want to abort it." | translate }}<br>
      <div class="buttons-flex-container">
        <button class="darkbutton button-left" ion-button round (click)="actionFinished()">{{"Finished" | translate }}</button>
        <button class="darkbutton button-right" ion-button round (click)="abortAction()">{{"Abort" | translate }}</button>
      </div>
    </div>

    <div *ngIf="pageCtrl == 'actionAborted'">
      {{"You aborted this action, it has been put back into your actions list." | translate }}
    </div>

    <div *ngIf="pageCtrl == 'actionFinished'">
      {{"Congrats! Is your project now accomplished or does it need more action?" | translate }}
      <div class="buttons-flex-container">
        <button class="darkbutton button-left" ion-button round (click)="goalFinished()">{{"Accomplished" | translate }}</button>
        <button class="darkbutton button-right" ion-button round (click)="goalNotFinished()">{{"Not yet" | translate }}</button>
      </div>
    </div>

    <div *ngIf="pageCtrl == 'goalFinished'">
      {{"Congratulations to finishing your goal! Now let's head on to achieving the next ones!" | translate }}
    </div>
  </div>

  <!-- ProjectsPage -->
  <div class="height-100" *ngIf="viewpoint == 'ProjectsPage'">
    <div *ngIf="pageCtrl == ''">
      
        <ion-card class="width-18 height-150px overflow-y-hidden overflow-x-hidden text-align-center margin-10 display-inline-block secondary border-radius-20px" no-lines *ngFor="let goal of goalList | async" (click)="reviewGoal(goal)">
          <ion-grid>
                <ion-row>
                  <ion-col col-9>
                    <h1 class="max-height-30px overflow-x-hidden width-90">{{goal.name}}</h1>
                  </ion-col>
                  <ion-col>
                    <ion-card class="margin-top-0 margin-right-0 project-color" [ngStyle]="{'background-color': goal.color}"></ion-card>
                  </ion-col>
                </ion-row>
                <ion-row>
              
              <p class="one-line border-top width-100 overflow-x-hidden" *ngFor="let action of actions[goal.key]">{{action.content}}</p>
                </ion-row>
              </ion-grid>
      </ion-card>
    </div>

    <p>{{errorMsg}}</p>

    <div class="height-100" *ngIf="pageCtrl == 'ProjectOverview'">
      <ion-grid class="height-100">
        <ion-row class="height-100">
          <ion-col col-9 class="no-padding">
            <ion-grid class="height-100 no-padding">
              <ion-row class="height-50">
                <ion-col col-4>
                  <ion-card class="height-45 margin-0 margin-bottom-10 width-100 secondary border-radius-20px">
                    <ion-grid>
                      <ion-row>
                        <ion-col col-9>
                          <h1>{{goal.name}}</h1>
                        </ion-col>
                        <ion-col>
                          <ion-card class="margin-top-0 margin-right-0 project-color" [ngStyle]="{'background-color': goal.color}"></ion-card>
                        </ion-col>
                      </ion-row>
                    </ion-grid>
                  </ion-card>
                  <ion-item class="height-50 secondary border-radius-20px">{{"Team" | translate }}</ion-item>
                </ion-col>
                <ion-col col-8>
                  <calendar [eventSource]="eventSource"
                    [calendarMode]="calendar.mode"
                    [currentDate]="calendar.currentDate"
                    (onEventSelected)="onEventSelected($event)"
                    (onTitleChanged)="onViewTitleChanged($event)"
                    (onTimeSelected)="onTimeSelected($event)"
                    step="5"
                    class="calendar"
                    autoSelect="false">
                  </calendar>
                </ion-col>
              </ion-row>
              <ion-row class="height-50 margin-5">
                <ion-item class="height-100 secondary border-radius-20px">
                  <ion-grid class="height-100">
                    <ion-row class="height-100">
                      <ion-col class="border-right">{{"Actions" | translate }}
                        <button class="block width-100 no-padding" *ngFor="let nextAction of nextActionList | async" (click)="reviewAction(nextAction)">
                          <p class="border-top">{{nextAction.content}}</p>
                        </button>
                      </ion-col>
                      <ion-col class="border-right">{{"Delegations" | translate }}
                        <button class="block width-100 no-padding" *ngFor="let delegation of delegationList | async" (click)="reviewDelegation(delegation)">
                          <p class="border-top">{{delegation.content}}</p>
                        </button>
                      </ion-col>
                      <ion-col>{{"References" | translate }}
                        <button class="block width-100 no-padding" *ngFor="let reference of referenceList | async" (click)="reviewReference(reference)">
                          <p class="border-top">{{reference.content}}</p>
                        </button>
                      </ion-col>
                    </ion-row>
                  </ion-grid>
                </ion-item>
              </ion-row>
            </ion-grid>
          </ion-col>
          <ion-col col-3>
            <ion-item class="height-100 secondary border-radius-20px">{{"Chat" | translate }}</ion-item>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>

    <div *ngIf="pageCtrl == 'editAction'">
        {{"Edit action" | translate }}
        <ion-list inset>
          <form (ngSubmit)="editAction()" [formGroup]="editActionForm">
            <ion-item no-lines>
              <ion-input type="text" value="{{action.content}}" formControlName="content"></ion-input>
            </ion-item>
            <ion-item no-lines>
              <ion-label>{{"Priority (1: low, 10: high)" | translate }}:</ion-label>
              <ion-input type="number" value="{{action.priority}}" min="0" max="10" formControlName="priority"></ion-input>
            </ion-item>
            <ion-item no-lines>
                <ion-label block>{{"Estimated time in min" | translate }}:</ion-label>
                <ion-input type="number" value="{{action.time}}" min="0" max="1000" formControlName="time"></ion-input>
            </ion-item>
            <ion-item no-lines>
              <ion-label>{{"Deadline" | translate }}</ion-label>
              <ion-datetime displayFormat="D.MMM.YYYY" formControlName="deadline" max="2099-12-31" placeholder="Choose deadline"></ion-datetime>
            </ion-item>
            <button class="darkbutton" ion-button full type="submit">Edit</button>
          </form>
        </ion-list>
      </div>

      <div *ngIf="pageCtrl == 'editDelegation'">
        {{"Edit delegation" | translate }}
        <ion-list inset>
          <form (ngSubmit)="editDelegation()" [formGroup]="editDelegationForm">
            <ion-item no-lines>
              <ion-input type="text" value="{{delegation.content}}" formControlName="content"></ion-input>
            </ion-item>
            <ion-item no-lines>
              <ion-label>{{"Deadline" | translate }}</ion-label>
              <ion-datetime displayFormat="D.MMM.YYYY" formControlName="deadline" max="2099-12-31" placeholder="{{'Choose deadline' | translate }}"></ion-datetime>
            </ion-item>
            <button class="darkbutton" ion-button full type="submit">{{"Edit" | translate }}</button>
          </form>
        </ion-list>
      </div>

      <div *ngIf="pageCtrl == 'editReference'">
          {{"Edit reference" | translate }}
          <ion-list inset>
            <form (ngSubmit)="editReference()" [formGroup]="editReferenceForm">
              <ion-item no-lines>
                <ion-input type="text" value="{{reference.content}}" formControlName="content"></ion-input>
              </ion-item>
              <button class="darkbutton" ion-button full type="submit">{{"Edit" | translate }}</button>
            </form>
          </ion-list>
      </div>
    </div>

    <!-- ToDoPage -->
    <div *ngIf="viewpoint == 'ToDoPage'">
      <div *ngIf="pageCtrl == ''">
        <ion-grid>
          <ion-row>
            <ion-col size="1" class="primary">
              <form class="flex" (ngSubmit)="showDoableActions()" [formGroup]="giveTimeForm">
                  <ion-label class="primary display-inline-block">{{"Time available in minutes" | translate }}:</ion-label>
                  <ion-input type="number" min="0" formControlName="timeEstimate"></ion-input>
              </form>
            </ion-col>
            <ion-col col-8>
              <ion-item class="border-radius-20px">
              <ion-select [(ngModel)]="goal.key" (ionChange)="chooseGoal($event)">
                <ion-option selected value="None">{{"All Projects" | translate }}</ion-option>
                <ion-option *ngFor="let goal of goalArray" value="{{goal.key}}">{{goal.name}}</ion-option>
              </ion-select>
              </ion-item>
            </ion-col>
          </ion-row>
          <ion-row class="height-100">
            <ion-col>
            <p class="primary">{{errorMsg}}</p>
            <div class="content-container">
              <ion-item no-lines *ngFor="let action of doableActionArray" (click)="takeThisAction(action)">
                <div [innerHtml]="action.content"></div>
              </ion-item>
            </div>
          </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </div>

    <!-- CalendarPage -->
    <div class="height-100 secondary border-radius-20px" *ngIf="viewpoint == 'CalendarPage'">
      <ion-row>
        <ion-col col-3>
          <ion-buttons start>
            <button class="darkbutton" ion-button icon-only (click)="addEvent()">
              <ion-icon name="add"></ion-icon>
            </button>
          </ion-buttons>
        </ion-col>
        <ion-col style="text-align: center">
          <h2>{{ viewTitle }}</h2>
        </ion-col>
      </ion-row>
      <div class="padding-bottom-50 height-90">
        <calendar [eventSource]="eventSource"
                  [calendarMode]="calendar.mode"
                  [currentDate]="calendar.currentDate"
                  (onEventSelected)="onEventSelected($event)"
                  (onTitleChanged)="onViewTitleChanged($event)"
                  (onTimeSelected)="onTimeSelected($event)"
                  step="5"
                  class="calendar"
                  autoSelect="false">
        </calendar>
      </div>




    </div>






</ion-content>