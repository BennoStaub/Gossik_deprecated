<ion-header>
  <div class="header-container">
    <img class="header-logo" src="../../assets/imgs/logo_schriftzug_weiss.png" height="60">
    <div class="header-icons-div">
      <button class="header-icon" (click)="goToCalendarPage()">
        <img src="../../assets/icon/icon_calendar.png" height="20"> {{"Calendar" | translate }}
      </button>
      <button class="header-icon" (click)="goToToDoPage()">
        <img src="../../assets/icon/icon_todo.png" height="20"> {{"ToDo" | translate }}
      </button>
      <button class="header-icon" (click)="goToProjectsPage()">
        <img src="../../assets/icon/icon_projects.png" height="20"> {{"Projects" | translate }}
      </button>
      <button class="header-icon" (click)="goToCapturePage()">
        <img src="../../assets/icon/icon_captures.png" height="20"> {{"Captures" | translate }}
      </button>
    </div>
  </div>
</ion-header>
 
  <ion-content padding>

  <!-- CapturePage -->
  <div *ngIf="viewpoint == 'CapturePage'">
    <ion-row>
      <p>{{errorMsg | translate}}</p>
   
    <ion-item class="secondary border-radius-20px">
      <ion-label stacked>{{"Content" | translate}}</ion-label>
      <ion-textarea [(ngModel)]="newCapture.content" placeholder="{{'Input new capture'| translate}}"></ion-textarea>
    </ion-item>
    <button class="darkbutton" ion-button block (click)="addCapture(newCapture)">{{"Add" | translate}}</button>
    </ion-row>
    <div class="secondary border-radius-20px">
      <ion-item class="border-radius-20px" no-lines text-wrap *ngFor="let takenAction of takenActionList | async" (click)="goToProcessTakenActionPage(takenAction)">
        <div class="ion-item-bg"></div>
        <div>{{"You started with action" |translate}} "{{takenAction.content}}" {{", click here to process" | translate }}</div>
      </ion-item>
    </div>
    <p>{{"Thoughts captured and ready for processing" | translate}}:</p>
    <div class="secondary border-radius-20px">
      <ion-item class="border-radius-20px" no-lines text-wrap *ngFor="let capture of captureList | async" (click)="goToProcessCapturePage(capture)">
        <div class="ion-item-bg" [innerHtml]="capture.content" (swipe)="removeCapture(capture)"></div>
      </ion-item>
    </div>
  </div>

  <!-- ProcessCapturePage -->
  <div *ngIf="viewpoint=='ProcessCapturePage'">
    <p>{{errorMsg}}</p>
    <div *ngIf="pageCtrl == ''">
      <ion-grid>
        <ion-row class="width-100">
          <ion-col col-3>
            <ion-item class="secondary border-radius-20px margin-10">
              {{capture.content}}
            </ion-item>
          </ion-col>
          <ion-col>
            <ion-card class="width-20 height-20 overflow-scroll no-scrollbar margin-right-10 display-inline-block secondary border-radius-20px min-height-150px">
            <ion-input type="text" [(ngModel)]="goalname" placeholder="{{'Project name' | translate}}"></ion-input>

          <button ion-button round class="darkbutton" (click)="addGoal(goalname)">{{"Create" | translate }}</button>
        </ion-card>
            
            <ion-item class="width-auto height-20 overflow-scroll no-scrollbar margin-10 display-inline-block secondary border-radius-20px min-height-150px" no-lines *ngFor="let goal of goalList | async" (click)="reviewGoal(goal)">
              <h1>{{goal.name}}</h1>
              <button class="darkbutton button-left" ion-button round (click)="goToDefineAction(goal)">{{"Action" | translate }}</button>
              <button class="darkbutton button-left" ion-button round (click)="goToDefineDelegation(goal)">{{"Delegation" | translate }}</button>
              <button class="darkbutton button-left" ion-button round (click)="goToDefineMaterial(goal)">{{"Reference" | translate }}</button>
                
            </ion-item>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>


    <div *ngIf="pageCtrl == 'defineAction'">
      {{"Defining new action" | translate }}
      <ion-list inset>
        <ion-item no-lines>
          <ion-label>{{"Deadline required?" | translate }}</ion-label>
          <ion-checkbox [(ngModel)]="checkDeadline"></ion-checkbox>
        </ion-item>
        <form (ngSubmit)="addAction()" [formGroup]="defineActionForm">
          <ion-item no-lines>
            <ion-input type="text" placeholder="{{'Action' | translate }}" formControlName="content"></ion-input>
          </ion-item>
          <ion-item>
            <ion-label>{{"Priority (1: low, 10: high)" | translate }}:</ion-label>
            <ion-input type="number" placeholder="0" min="0" max="10" formControlName="priority"></ion-input>
          </ion-item>
          <ion-item>
              <ion-label block>{{"Estimated time in min" | translate }}:</ion-label>
              <ion-input type="number" placeholder="0" min="0" max="1000" formControlName="time"></ion-input>
          </ion-item>
          <div *ngIf="checkDeadline">
            <ion-item no-lines>
              <ion-datetime displayFormat="DD.MMM YYYY" pickerFormat="DD MMM YYYY" max="2100" formControlName="deadline" placeholder="{{'Choose deadline' | translate }}" ></ion-datetime>
            </ion-item>
          </div>
          <button class="darkbutton" ion-button full type="submit">{{"Define action" | translate }}</button>
        </form>
      </ion-list>
    </div>

    <div *ngIf="pageCtrl == 'defineDelegation'">
        {{"Defining new delegation" | translate }}:
        <ion-list inset>
          <ion-item no-lines>
            <ion-label>{{"Deadline required?" | translate }}</ion-label>
            <ion-checkbox [(ngModel)]="checkDeadline"></ion-checkbox>
          </ion-item>
          <form (ngSubmit)="addDelegation()" [formGroup]="defineDelegationForm">
            <ion-item no-lines>
              <ion-input type="text" placeholder="{{'Delegation' | translate }}" formControlName="content"></ion-input>
            </ion-item>
            <div *ngIf="checkDeadline">
              <ion-item no-lines>
                <ion-datetime displayFormat="DD.MMM YYYY" pickerFormat="DD MMM YYYY" max="2100" formControlName="deadline" placeholder="{{'Choose deadline' | translate }}"></ion-datetime>
              </ion-item>
            </div>
            <button class="darkbutton" ion-button full type="submit">{{"Define delegation" | translate }}</button>
          </form>
        </ion-list>
      </div>

    <div *ngIf="pageCtrl == 'defineReference'">
      {{"Defining new reference:" | translate }}
      <ion-list inset>
        <form (ngSubmit)="addReference()" [formGroup]="defineReferenceForm">
          <ion-item no-lines>
            <ion-input type="text" value="{{capture.content}}" formControlName="content"></ion-input>
          </ion-item>
          <button class="darkbutton" ion-button full type="submit">{{"Define reference" | translate }}</button>
        </form>
      </ion-list>
    </div>
  </div>

  <!-- ProcessTakenActionPage -->
  <div *ngIf="viewpoint=='ProcessTakenActionPage'">
    <div *ngIf="pageCtrl == ''">
      {{"Please indicate whether you finished the action or want to abort it." | translate }}<br>
      <div class="buttons-flex-container">
        <button class="darkbutton button-left" ion-button round (click)="actionFinished()">{{"Finished" | translate }}</button>
        <button class="darkbutton button-right" ion-button round (click)="abortAction()">{{"Abort" | translate }}</button>
      </div>
    </div>

    <div *ngIf="pageCtrl == 'actionAborted'">
      {{"You aborted this action, it has been put back into your actions list." | translate }}
    </div>

    <div *ngIf="pageCtrl == 'actionFinished'">
      {{"Congrats! Is your project now accomplished or does it need more action?" | translate }}
      <div class="buttons-flex-container">
        <button class="darkbutton button-left" ion-button round (click)="goalFinished()">{{"Accomplished" | translate }}</button>
        <button class="darkbutton button-right" ion-button round (click)="goalNotFinished()">{{"Not yet" | translate }}</button>
      </div>
    </div>

    <div *ngIf="pageCtrl == 'goalFinished'">
      {{"Congratulations to finishing your goal! Now let's head on to achieving the next ones!" | translate }}
    </div>
  </div>

  <!-- ProjectsPage -->
  <div class="height-100" *ngIf="viewpoint == 'ProjectsPage'">
    <div *ngIf="pageCtrl == ''">
        <ion-item class="width-18 height-20 overflow-scroll no-scrollbar margin-10 display-inline-block secondary border-radius-20px min-height-150px" no-lines *ngFor="let goal of goalList | async" (click)="reviewGoal(goal)">
          <h1>{{goal.name}}</h1>
          <p class="border-top" *ngFor="let action of actions[goal.key]">{{action.content}}</p>
      </ion-item>
    </div>

    <p>{{errorMsg}}</p>

    <div class="height-100" *ngIf="pageCtrl == 'ProjectOverview'">
      <ion-grid class="height-100">
        <ion-row class="height-100">
          <ion-col col-9 class="no-padding">
            <ion-grid class="height-100 no-padding">
              <ion-row class="height-50">
                <ion-col col-4>
                  <ion-item class="height-45 margin-bottom-10 secondary border-radius-20px"><h1>{{goal.name}}</h1></ion-item>
                  <ion-item class="height-50 secondary border-radius-20px">{{"Team" | translate }}</ion-item>
                </ion-col>
                <ion-col col-8>
                  <calendar [eventSource]="eventSource"
                    [calendarMode]="calendar.mode"
                    [currentDate]="calendar.currentDate"
                    (onEventSelected)="onEventSelected($event)"
                    (onTitleChanged)="onViewTitleChanged($event)"
                    (onTimeSelected)="onTimeSelected($event)"
                    step="5"
                    class="calendar"
                    autoSelect="false">
                  </calendar>
                </ion-col>
              </ion-row>
              <ion-row class="height-50 margin-5">
                <ion-item class="height-100 secondary border-radius-20px">
                  <ion-grid class="height-100">
                    <ion-row class="height-100">
                      <ion-col class="border-right">{{"Actions" | translate }}
                        <button class="block width-100 no-padding" *ngFor="let nextAction of nextActionList | async" (click)="reviewAction(nextAction)">
                          <p class="border-top">{{nextAction.content}}</p>
                        </button>
                      </ion-col>
                      <ion-col class="border-right">{{"Delegations" | translate }}
                        <button class="block width-100 no-padding" *ngFor="let delegation of delegationList | async" (click)="reviewDelegation(delegation)">
                          <p class="border-top">{{delegation.content}}</p>
                        </button>
                      </ion-col>
                      <ion-col>{{"References" | translate }}
                        <button class="block width-100 no-padding" *ngFor="let reference of referenceList | async" (click)="reviewReference(reference)">
                          <p class="border-top">{{reference.content}}</p>
                        </button>
                      </ion-col>
                    </ion-row>
                  </ion-grid>
                </ion-item>
              </ion-row>
            </ion-grid>
          </ion-col>
          <ion-col col-3>
            <ion-item class="height-100 secondary border-radius-20px">{{"Chat" | translate }}</ion-item>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>

    <div *ngIf="pageCtrl == 'editAction'">
        {{"Edit action" | translate }}
        <ion-list inset>
          <form (ngSubmit)="editAction()" [formGroup]="editActionForm">
            <ion-item no-lines>
              <ion-input type="text" value="{{action.content}}" formControlName="content"></ion-input>
            </ion-item>
            <ion-item no-lines>
              <ion-label>{{"Priority (1: low, 10: high)" | translate }}:</ion-label>
              <ion-input type="number" value="{{action.priority}}" min="0" max="10" formControlName="priority"></ion-input>
            </ion-item>
            <ion-item no-lines>
                <ion-label block>{{"Estimated time in min" | translate }}:</ion-label>
                <ion-input type="number" value="{{action.time}}" min="0" max="1000" formControlName="time"></ion-input>
            </ion-item>
            <ion-item no-lines>
              <ion-label>{{"Deadline" | translate }}</ion-label>
              <ion-datetime displayFormat="D.MMM.YYYY" formControlName="deadline" max="2099-12-31" placeholder="Choose deadline"></ion-datetime>
            </ion-item>
            <button class="darkbutton" ion-button full type="submit">Edit</button>
          </form>
        </ion-list>
      </div>

      <div *ngIf="pageCtrl == 'editDelegation'">
        {{"Edit delegation" | translate }}
        <ion-list inset>
          <form (ngSubmit)="editDelegation()" [formGroup]="editDelegationForm">
            <ion-item no-lines>
              <ion-input type="text" value="{{delegation.content}}" formControlName="content"></ion-input>
            </ion-item>
            <ion-item no-lines>
              <ion-label>{{"Deadline" | translate }}</ion-label>
              <ion-datetime displayFormat="D.MMM.YYYY" formControlName="deadline" max="2099-12-31" placeholder="{{'Choose deadline' | translate }}"></ion-datetime>
            </ion-item>
            <button class="darkbutton" ion-button full type="submit">{{"Edit" | translate }}</button>
          </form>
        </ion-list>
      </div>

      <div *ngIf="pageCtrl == 'editReference'">
          {{"Edit reference" | translate }}
          <ion-list inset>
            <form (ngSubmit)="editReference()" [formGroup]="editReferenceForm">
              <ion-item no-lines>
                <ion-input type="text" value="{{reference.content}}" formControlName="content"></ion-input>
              </ion-item>
              <button class="darkbutton" ion-button full type="submit">{{"Edit" | translate }}</button>
            </form>
          </ion-list>
      </div>
    </div>

    <!-- ToDoPage -->
    <div *ngIf="viewpoint == 'ToDoPage'">
      <div *ngIf="pageCtrl == ''">
        <ion-grid>
          <ion-row>
            <ion-col size="1">
              <form (ngSubmit)="showDoableActions()" [formGroup]="giveTimeForm">
                <ion-item class="primary">
                  <ion-label class="primary">{{"Time available in minutes" | translate }}:</ion-label>
                  <ion-input type="number" min="0" formControlName="timeEstimate"></ion-input>
                </ion-item>
              </form>
            </ion-col>
            <ion-col col-8>
              <ion-item class="border-radius-20px">
              <ion-select [(ngModel)]="goal.key" (ionChange)="chooseGoal($event)">
                <ion-option selected value="None">{{"All Projects" | translate }}</ion-option>
                <ion-option *ngFor="let goal of goalArray" value="{{goal.key}}">{{goal.name}}</ion-option>
              </ion-select>
              </ion-item>
            </ion-col>
          </ion-row>
          <ion-row class="height-100">
            <ion-col>
            <p class="primary">{{errorMsg}}</p>
            <div class="content-container">
              <ion-item no-lines *ngFor="let action of doableActionArray" (click)="takeThisAction(action)">
                <div [innerHtml]="action.content"></div>
              </ion-item>
            </div>
          </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </div>

    <!-- CalendarPage -->
    <div class="height-100" *ngIf="viewpoint == 'CalendarPage'">
      <ion-row>
        <ion-buttons end>
          <button class="darkbutton" ion-button icon-only (click)="addEvent()">
            <ion-icon name="add"></ion-icon>
          </button>
        </ion-buttons>
        <ion-col style="text-align: center">
          <h2 class="white">{{ viewTitle }}</h2>
        </ion-col>
      </ion-row>
      <div class="padding-bottom-50 height-100">
        <calendar [eventSource]="eventSource"
                  [calendarMode]="calendar.mode"
                  [currentDate]="calendar.currentDate"
                  (onEventSelected)="onEventSelected($event)"
                  (onTitleChanged)="onViewTitleChanged($event)"
                  (onTimeSelected)="onTimeSelected($event)"
                  step="5"
                  class="calendar"
                  autoSelect="false">
        </calendar>
      </div>




    </div>






</ion-content>